<!DOCTYPE html>
<html>
<head>
    <title>CybernaWallet</title>
</head>
<body>
    <h1>Bienvenue sur CybernaWallet</h1>

    <button onclick="generateWallet()">Créer un Wallet</button>
    <div id="wallet_info"></div>

    <h2>Échanger des CBR contre des BTC</h2>
    <input id="cbr_amount" placeholder="Montant en CBR">
    <button onclick="swapCBR()">Swap</button>

    <h2>Envoyer des BTC</h2>
    <input id="to_address" placeholder="Adresse BTC">
    <input id="amount" placeholder="Montant en BTC">
    <button onclick="sendBTC()">Envoyer</button>

    <script>
        async function generateWallet() {
            const response = await fetch('/generate_wallet', { method: 'POST' });
            const data = await response.json();
            document.getElementById('wallet_info').innerHTML = `
                Adresse publique : ${data.public_address}<br>
                Solde CBR : ${data.cbr_balance} CBR<br>
                Solde BTC : ${data.btc_balance} BTC
            `;
        }

        async function swapCBR() {
            const cbr_amount = document.getElementById('cbr_amount').value;
            const response = await fetch('/swap_cbr_to_btc', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ cbr_amount })
            });
            const data = await response.json();
            alert(`Vous avez reçu ${data.btc_amount} BTC`);
        }

        async function sendBTC() {
            const to_address = document.getElementById('to_address').value;
            const amount = document.getElementById('amount').value;
            const response = await fetch('/send_btc', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ to_address, amount })
            });
            const data = await response.json();
            alert('Transaction envoyée : ' + JSON.stringify(data));
        }
    </script>
</body>
</html>
